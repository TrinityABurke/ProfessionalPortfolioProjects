<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2202.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 21.6px; font: 12.0px Courier; color: #cc004e; -webkit-text-stroke: #cc004e; background-color: #fffffe}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 21.6px; font: 12.0px Times; color: #000000; -webkit-text-stroke: #000000; background-color: #fffffe}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 21.6px; font: 12.0px Courier; color: #274ecc; -webkit-text-stroke: #274ecc; background-color: #fffffe}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 21.6px; font: 12.0px Courier; color: #15813e; -webkit-text-stroke: #15813e; background-color: #fffffe}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 21.6px; font: 12.0px Courier; color: #000000; -webkit-text-stroke: #000000; background-color: #fffffe}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 21.6px; font: 12.0px Courier; color: #2a373e; -webkit-text-stroke: #2a373e; background-color: #fffffe}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; color: #000000; -webkit-text-stroke: #000000; min-height: 14.0px}
    span.s1 {font-kerning: none}
    span.s2 {font-kerning: none; color: #000000; -webkit-text-stroke: 0px #000000}
    span.s3 {font-kerning: none; color: #2a373e; -webkit-text-stroke: 0px #2a373e}
    span.s4 {font-kerning: none; color: #274ecc; -webkit-text-stroke: 0px #274ecc}
    span.s5 {font-kerning: none; color: #ee3918; -webkit-text-stroke: 0px #ee3918}
    span.s6 {font-kerning: none; color: #6b0001; -webkit-text-stroke: 0px #6b0001}
  </style>
</head>
<body>
<p class="p1"><span class="s1">#Global COVID-19 Data Exploration Portfolio Project</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#For this analysis I have already checked and cleaned the data in Excel and Google Sheets and will be using BigQuery to demonstrate using multiple functions to analyze the information</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#First I will check to make sure both tables have loaded into the dataset correctly. I made sure the location and date columns were presented in ascending order for easier viewing.</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p3"><span class="s1">SELECT</span><span class="s2"> </span><span class="s3">*</span></p>
<p class="p4"><span class="s4">FROM</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_deaths`</span></p>
<p class="p3"><span class="s1">ORDER</span><span class="s2"> </span><span class="s1">BY</span><span class="s2"> </span><span class="s5">3</span><span class="s2">,</span><span class="s5">4</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p3"><span class="s1">SELECT</span><span class="s3">*</span></p>
<p class="p4"><span class="s4">FROM</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_vaccs`</span></p>
<p class="p3"><span class="s1">ORDER</span><span class="s2"> </span><span class="s1">BY</span><span class="s2"> </span><span class="s5">3</span><span class="s2">,</span><span class="s5">4</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#Next I will select the data I will be starting with for the analysis</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p5"><span class="s4">SELECT</span><span class="s1"> location, </span><span class="s4">date</span><span class="s1">, total_cases, new_cases, total_deaths,population</span></p>
<p class="p4"><span class="s4">FROM</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_deaths`</span></p>
<p class="p3"><span class="s1">WHERE</span><span class="s2"> continent </span><span class="s1">is</span><span class="s2"> </span><span class="s1">not</span><span class="s2"> </span><span class="s1">NULL</span></p>
<p class="p3"><span class="s1">ORDER</span><span class="s2"> </span><span class="s1">BY</span><span class="s2"> </span><span class="s5">1</span><span class="s2">,</span><span class="s5">2</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#I want to find out the percentage of people dying after having a confirmed COVID19 infection. To get the percentage I will create an equation and rename. This information helps the public and professionals know the chances someone has of dying if contracting COVID19.</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#Total Case VS Total Deaths</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p5"><span class="s4">SELECT</span><span class="s1"> location, </span><span class="s4">date</span><span class="s1">, total_cases, total_deaths, </span><span class="s3">(</span><span class="s1">total_deaths</span><span class="s3">/</span><span class="s1">total_cases</span><span class="s3">)*</span><span class="s5">100</span><span class="s1"> </span><span class="s4">AS</span><span class="s1"> DeathPercentage</span></p>
<p class="p4"><span class="s4">FROM</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_deaths`</span></p>
<p class="p3"><span class="s1">ORDER</span><span class="s2"> </span><span class="s1">BY</span><span class="s2"> </span><span class="s5">1</span><span class="s2">,</span><span class="s5">2</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#Now I want to look at the countries with the highest percentage rate of confirmed cases compared to their population. Because I want the highest percentage results and the highest number of cases I use MAX twice. To avoid a syntax error I have to group location and population. Since the percentage is the most important info I ordered by that column and made sure to get results in highest order first</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#Highest Infection Count VS Population</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p5"><span class="s4">SELECT</span><span class="s1"> location, Population, </span><span class="s4">MAX</span><span class="s3">(</span><span class="s1">total_cases</span><span class="s3">)</span><span class="s1"> </span><span class="s4">AS</span><span class="s1"> HighestInfectionCount,</span><span class="s4">MAX</span><span class="s3">((</span><span class="s1">total_cases</span><span class="s3">/</span><span class="s1">population</span><span class="s3">))*</span><span class="s5">100</span><span class="s1"> </span><span class="s4">as</span><span class="s1"> ConfirmedCasesPercentage</span></p>
<p class="p4"><span class="s4">FROM</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_deaths`</span></p>
<p class="p5"><span class="s4">GROUP</span><span class="s1"> </span><span class="s4">BY</span><span class="s1"> location, population</span></p>
<p class="p5"><span class="s4">ORDER</span><span class="s1"> </span><span class="s4">BY</span><span class="s1"> ConfirmedCasesPercentage </span><span class="s4">DESC</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#Here I will look at what countries have the Highest Death Count. Because I want the highest results, I use MAX and rename equation.Because of the original data file for total_deaths, I need to use CAST to convert the output to an integer using AS int in parenthesis so that it’s read as a numeric</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p5"><span class="s4">SELECT</span><span class="s1"> location, </span><span class="s4">MAX</span><span class="s3">(</span><span class="s4">cast</span><span class="s3">(</span><span class="s1">total_deaths </span><span class="s4">as</span><span class="s1"> int</span><span class="s3">))</span><span class="s1"> </span><span class="s4">AS</span><span class="s1"> TotalDeathCount</span></p>
<p class="p4"><span class="s4">FROM</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_deaths`</span></p>
<p class="p5"><span class="s4">GROUP</span><span class="s1"> </span><span class="s4">BY</span><span class="s1"> location</span></p>
<p class="p5"><span class="s4">ORDER</span><span class="s1"> </span><span class="s4">BY</span><span class="s1"> TotalDeathCount </span><span class="s4">DESC</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#After the above results I noticed there was an issue with the data. In the Location column there were continents listed along with countries so I added a WHERE statement.</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p5"><span class="s4">SELECT</span><span class="s1"> location, </span><span class="s4">MAX</span><span class="s3">(</span><span class="s4">cast</span><span class="s3">(</span><span class="s1">total_deaths </span><span class="s4">as</span><span class="s1"> int</span><span class="s3">))</span><span class="s1"> </span><span class="s4">AS</span><span class="s1"> TotalDeathCount</span></p>
<p class="p4"><span class="s4">FROM</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_deaths`</span></p>
<p class="p3"><span class="s1">WHERE</span><span class="s2"> continent </span><span class="s1">is</span><span class="s2"> </span><span class="s1">not</span><span class="s2"> </span><span class="s1">null</span></p>
<p class="p5"><span class="s4">GROUP</span><span class="s1"> </span><span class="s4">BY</span><span class="s1"> location</span></p>
<p class="p5"><span class="s4">ORDER</span><span class="s1"> </span><span class="s4">BY</span><span class="s1"> TotalDeathCount </span><span class="s4">DESC</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#Now I will break down the results by CONTINENT</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p5"><span class="s4">SELECT</span><span class="s1"> continent, </span><span class="s4">MAX</span><span class="s3">(</span><span class="s4">cast</span><span class="s3">(</span><span class="s1">total_deaths </span><span class="s4">as</span><span class="s1"> int</span><span class="s3">))</span><span class="s1"> </span><span class="s4">AS</span><span class="s1"> TotalDeathCount</span></p>
<p class="p4"><span class="s4">FROM</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_deaths`</span></p>
<p class="p3"><span class="s1">WHERE</span><span class="s2"> continent </span><span class="s1">is</span><span class="s2"> </span><span class="s1">not</span><span class="s2"> </span><span class="s1">null</span></p>
<p class="p5"><span class="s4">GROUP</span><span class="s1"> </span><span class="s4">BY</span><span class="s1"> continent</span></p>
<p class="p5"><span class="s4">ORDER</span><span class="s1"> </span><span class="s4">BY</span><span class="s1"> TotalDeathCount </span><span class="s4">DESC</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p5"><span class="s4">SELECT</span><span class="s1"> location, </span><span class="s4">MAX</span><span class="s3">(</span><span class="s4">cast</span><span class="s3">(</span><span class="s1">total_deaths </span><span class="s4">as</span><span class="s1"> int</span><span class="s3">))</span><span class="s1"> </span><span class="s4">AS</span><span class="s1"> TotalDeathCount</span></p>
<p class="p4"><span class="s4">FROM</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_deaths`</span></p>
<p class="p5"><span class="s4">WHERE</span><span class="s1"> continent </span><span class="s4">is</span><span class="s1"> </span><span class="s4">null</span></p>
<p class="p5"><span class="s4">GROUP</span><span class="s1"> </span><span class="s4">BY</span><span class="s1"> location</span></p>
<p class="p5"><span class="s4">ORDER</span><span class="s1"> </span><span class="s4">BY</span><span class="s1"> TotalDeathCount </span><span class="s4">DESC</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#Below are the COVID cases compared to deaths globally as a percentage</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p5"><span class="s4">SELECT</span><span class="s1"> </span><span class="s4">date</span><span class="s1">,</span><span class="s4">SUM</span><span class="s3">(</span><span class="s1">new_cases</span><span class="s3">)</span><span class="s1"> </span><span class="s4">as</span><span class="s1"> total_cases, </span><span class="s4">SUM</span><span class="s3">(</span><span class="s4">cast</span><span class="s3">(</span><span class="s1">new_deaths </span><span class="s4">as</span><span class="s1"> int</span><span class="s3">))</span><span class="s1"> </span><span class="s4">as</span><span class="s1"> total_deaths, </span><span class="s4">SUM</span><span class="s3">(</span><span class="s4">cast</span><span class="s3">(</span><span class="s1">new_deaths </span><span class="s4">as</span><span class="s1"> int</span><span class="s3">))/</span><span class="s4">SUM</span><span class="s3">(</span><span class="s1">new_cases</span><span class="s3">)*</span><span class="s5">100</span><span class="s1"> </span><span class="s4">as</span><span class="s1"> DeathPercentage</span></p>
<p class="p4"><span class="s4">FROM</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_deaths`</span></p>
<p class="p3"><span class="s1">WHERE</span><span class="s2"> continent </span><span class="s1">is</span><span class="s2"> </span><span class="s1">not</span><span class="s2"> </span><span class="s1">null</span></p>
<p class="p3"><span class="s1">GROUP</span><span class="s2"> </span><span class="s1">BY</span><span class="s2"> </span><span class="s1">date</span></p>
<p class="p3"><span class="s1">ORDER</span><span class="s2"> </span><span class="s1">BY</span><span class="s2"> </span><span class="s5">1</span><span class="s2">,</span><span class="s5">2</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#The total number of COVID cases compared to deaths globally so far</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p5"><span class="s4">SELECT</span><span class="s1"> </span><span class="s4">SUM</span><span class="s3">(</span><span class="s1">new_cases</span><span class="s3">)</span><span class="s1"> </span><span class="s4">as</span><span class="s1"> total_cases, </span><span class="s4">SUM</span><span class="s3">(</span><span class="s4">cast</span><span class="s3">(</span><span class="s1">new_deaths </span><span class="s4">as</span><span class="s1"> int</span><span class="s3">))</span><span class="s1"> </span><span class="s4">as</span><span class="s1"> total_deaths, </span><span class="s4">SUM</span><span class="s3">(</span><span class="s4">cast</span><span class="s3">(</span><span class="s1">new_deaths </span><span class="s4">as</span><span class="s1"> int</span><span class="s3">))/</span><span class="s4">SUM</span><span class="s3">(</span><span class="s1">new_cases</span><span class="s3">)*</span><span class="s5">100</span><span class="s1"> </span><span class="s4">as</span><span class="s1"> DeathPercentage</span></p>
<p class="p4"><span class="s4">FROM</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_deaths`</span></p>
<p class="p3"><span class="s1">WHERE</span><span class="s2"> continent </span><span class="s1">is</span><span class="s2"> </span><span class="s1">not</span><span class="s2"> </span><span class="s1">null</span></p>
<p class="p3"><span class="s1">ORDER</span><span class="s2"> </span><span class="s1">BY</span><span class="s2"> </span><span class="s5">1</span><span class="s2">,</span><span class="s5">2</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#Now I will be joining the two datasets to complete a few more analysis</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p3"><span class="s1">SELECT</span><span class="s2"> </span><span class="s3">*</span></p>
<p class="p4"><span class="s4">FROM</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_deaths`</span><span class="s2"> </span><span class="s4">AS</span><span class="s2"> deaths</span></p>
<p class="p4"><span class="s4">JOIN</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_vaccs`</span><span class="s2"> </span><span class="s4">AS</span><span class="s2"> vaccs</span></p>
<p class="p5"><span class="s4">ON</span><span class="s1"> deaths.</span><span class="s6">location</span><span class="s1"> = vaccs.location</span></p>
<p class="p5"><span class="s1"> </span><span class="s4">and</span><span class="s1"> deaths.</span><span class="s6">date</span><span class="s1"> = vaccs.</span><span class="s4">date</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#Now that I have the data combined, I will be looking at the Total Population vs Vaccinations</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p5"><span class="s4">SELECT</span><span class="s1"> deaths.continent, deaths.location, deaths.</span><span class="s4">date</span><span class="s1">, deaths.population, vaccs.new_vaccinations</span></p>
<p class="p4"><span class="s4">FROM</span><span class="s2"> </span><span class="s1">`northamericacoviddeaths.covid_deaths_data.covid_deaths`</span><span class="s2"> </span><span class="s4">AS</span><span class="s2"> deaths</span></p>
<p class="p4"><span class="s4">JOIN</span><span class="s2"> </span><span class="s1">`northamericacoviddeaths.covid_vaccs_data.covid_vaccs`</span><span class="s2"> </span><span class="s4">AS</span><span class="s2"> vaccs</span></p>
<p class="p5"><span class="s4">ON</span><span class="s1"> deaths.</span><span class="s6">location</span><span class="s1"> = vaccs.location</span></p>
<p class="p5"><span class="s1"> </span><span class="s4">and</span><span class="s1"> deaths.</span><span class="s6">date</span><span class="s1"> = vaccs.</span><span class="s4">date</span></p>
<p class="p5"><span class="s4">WHERE</span><span class="s1"> deaths.continent </span><span class="s4">is</span><span class="s1"> </span><span class="s4">not</span><span class="s1"> </span><span class="s4">null</span></p>
<p class="p3"><span class="s1">ORDER</span><span class="s2"> </span><span class="s1">BY</span><span class="s2"> </span><span class="s5">2</span><span class="s2">,</span><span class="s5">3</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#Looking at Total Population vs Vaccinations</span></p>
<p class="p1"><span class="s1">#Getting the SUM of vaccinations by turning it to an integer and creating a rolling count of new vaccinations per day by country by creating a Partition by location using OVER (once it gets to a new location_country it will start count again)</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p5"><span class="s4">SELECT</span><span class="s1"> deaths.continent, deaths.location, deaths.</span><span class="s4">date</span><span class="s1">, deaths.population, vaccs.new_vaccinations, </span><span class="s4">SUM</span><span class="s3">(</span><span class="s4">CAST</span><span class="s3">(</span><span class="s1">vaccs.new_vaccinations </span><span class="s4">AS</span><span class="s1"> int</span><span class="s3">))</span><span class="s1"> </span><span class="s4">OVER</span><span class="s1"> </span><span class="s3">(</span><span class="s4">Partition</span><span class="s1"> </span><span class="s4">by</span><span class="s1"> deaths.location</span><span class="s3">)</span></p>
<p class="p4"><span class="s4">FROM</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_deaths`</span><span class="s2"> </span><span class="s4">AS</span><span class="s2"> deaths</span></p>
<p class="p4"><span class="s4">JOIN</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_vaccs`</span><span class="s2"> </span><span class="s4">AS</span><span class="s2"> vaccs</span></p>
<p class="p5"><span class="s4">ON</span><span class="s1"> deaths.</span><span class="s6">location</span><span class="s1"> = vaccs.location</span></p>
<p class="p5"><span class="s1"> </span><span class="s4">and</span><span class="s1"> deaths.</span><span class="s6">date</span><span class="s1"> = vaccs.</span><span class="s4">date</span></p>
<p class="p5"><span class="s4">WHERE</span><span class="s1"> deaths.continent </span><span class="s4">is</span><span class="s1"> </span><span class="s4">not</span><span class="s1"> </span><span class="s4">null</span></p>
<p class="p3"><span class="s1">ORDER</span><span class="s2"> </span><span class="s1">BY</span><span class="s2"> </span><span class="s5">2</span><span class="s2">,</span><span class="s5">3</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#Looking at Total Population vs Vaccinations</span></p>
<p class="p1"><span class="s1">#Getting a rolling count of above code but also ordering Partitioned results by location and date</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p5"><span class="s4">SELECT</span><span class="s1"> deaths.continent, deaths.location, deaths.</span><span class="s4">date</span><span class="s1">, deaths.population, vaccs.new_vaccinations, </span><span class="s4">SUM</span><span class="s3">(</span><span class="s4">CAST</span><span class="s3">(</span><span class="s1">vaccs.new_vaccinations </span><span class="s4">AS</span><span class="s1"> int</span><span class="s3">))</span><span class="s1"> </span><span class="s4">OVER</span><span class="s1"> </span><span class="s3">(</span><span class="s4">Partition</span><span class="s1"> </span><span class="s4">by</span><span class="s1"> deaths.location </span><span class="s4">ORDER</span><span class="s1"> </span><span class="s4">BY</span><span class="s1"> deaths.location, deaths.</span><span class="s4">date</span><span class="s3">)</span></p>
<p class="p4"><span class="s4">FROM</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_deaths`</span><span class="s2"> </span><span class="s4">AS</span><span class="s2"> deaths</span></p>
<p class="p4"><span class="s4">JOIN</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_vaccs`</span><span class="s2"> </span><span class="s4">AS</span><span class="s2"> vaccs</span></p>
<p class="p5"><span class="s4">ON</span><span class="s1"> deaths.</span><span class="s6">location</span><span class="s1"> = vaccs.location</span></p>
<p class="p5"><span class="s1"> </span><span class="s4">and</span><span class="s1"> deaths.</span><span class="s6">date</span><span class="s1"> = vaccs.</span><span class="s4">date</span></p>
<p class="p5"><span class="s4">WHERE</span><span class="s1"> deaths.continent </span><span class="s4">is</span><span class="s1"> </span><span class="s4">not</span><span class="s1"> </span><span class="s4">null</span></p>
<p class="p3"><span class="s1">ORDER</span><span class="s2"> </span><span class="s1">BY</span><span class="s2"> </span><span class="s5">2</span><span class="s2">,</span><span class="s5">3</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#Here I will be creating a CTE so I can look at the number of RollingPeopleVaccinated vs Vaccinations by using the MAX number of RollingPeopleVaccinated and divide it by population to see how many people in that country are vaccinated</span></p>
<p class="p1"><span class="s1">#In order to do (RollingPeopleVaccinated/population)*100 I needed to create a CTE(common table expression)</span></p>
<p class="p1"><span class="s1">#Initially put column names in () after starting WITH however kept getting AS syntax error. Removed the column names and received the same results</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p5"><span class="s4">With</span><span class="s1"> PopvsVac</span></p>
<p class="p3"><span class="s1">AS</span></p>
<p class="p6"><span class="s1">(</span></p>
<p class="p5"><span class="s4">SELECT</span><span class="s1"> deaths.continent, deaths.location, deaths.</span><span class="s4">date</span><span class="s1">, deaths.population, vaccs.new_vaccinations, </span><span class="s4">SUM</span><span class="s3">(</span><span class="s4">CAST</span><span class="s3">(</span><span class="s1">vaccs.new_vaccinations </span><span class="s4">AS</span><span class="s1"> int</span><span class="s3">))</span><span class="s1"> </span><span class="s4">OVER</span><span class="s1"> </span><span class="s3">(</span><span class="s4">Partition</span><span class="s1"> </span><span class="s4">by</span><span class="s1"> deaths.location </span><span class="s4">ORDER</span><span class="s1"> </span><span class="s4">BY</span><span class="s1"> deaths.location, deaths.</span><span class="s4">date</span><span class="s3">)</span><span class="s1"> </span><span class="s4">as</span><span class="s1"> RollingPeopleVaccinated</span></p>
<p class="p4"><span class="s4">FROM</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_deaths`</span><span class="s2"> </span><span class="s4">AS</span><span class="s2"> deaths</span></p>
<p class="p4"><span class="s4">JOIN</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_vaccs`</span><span class="s2"> </span><span class="s4">AS</span><span class="s2"> vaccs</span></p>
<p class="p5"><span class="s4">ON</span><span class="s1"> deaths.</span><span class="s6">location</span><span class="s1"> = vaccs.location</span></p>
<p class="p5"><span class="s4">and</span><span class="s1"> deaths.</span><span class="s6">date</span><span class="s1"> = vaccs.</span><span class="s4">date</span></p>
<p class="p5"><span class="s4">WHERE</span><span class="s1"> deaths.continent </span><span class="s4">is</span><span class="s1"> </span><span class="s4">not</span><span class="s1"> </span><span class="s4">null</span></p>
<p class="p6"><span class="s1">)</span></p>
<p class="p3"><span class="s1">SELECT</span><span class="s2"> </span><span class="s3">*</span></p>
<p class="p5"><span class="s4">FROM</span><span class="s1"> PopvsVac</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#Lastly I will use the CTE created above to get a rolling percentage count of the number of people vaccinated by location</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p1"><span class="s1">#Looking at Total Population vs Vaccinations (FINAL)</span></p>
<p class="p2"><span class="s1"> </span></p>
<p class="p5"><span class="s4">With</span><span class="s1"> PopvsVac</span></p>
<p class="p3"><span class="s1">AS</span></p>
<p class="p6"><span class="s1">(</span></p>
<p class="p5"><span class="s4">SELECT</span><span class="s1"> deaths.continent, deaths.location, deaths.</span><span class="s4">date</span><span class="s1">, deaths.population, vaccs.new_vaccinations, </span><span class="s4">SUM</span><span class="s3">(</span><span class="s4">CAST</span><span class="s3">(</span><span class="s1">vaccs.new_vaccinations </span><span class="s4">AS</span><span class="s1"> int</span><span class="s3">))</span><span class="s1"> </span><span class="s4">OVER</span><span class="s1"> </span><span class="s3">(</span><span class="s4">Partition</span><span class="s1"> </span><span class="s4">by</span><span class="s1"> deaths.location </span><span class="s4">ORDER</span><span class="s1"> </span><span class="s4">BY</span><span class="s1"> deaths.location, deaths.</span><span class="s4">date</span><span class="s3">)</span><span class="s1"> </span><span class="s4">as</span><span class="s1"> RollingPeopleVaccinated</span></p>
<p class="p4"><span class="s4">FROM</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_deaths`</span><span class="s2"> </span><span class="s4">AS</span><span class="s2"> deaths</span></p>
<p class="p4"><span class="s4">JOIN</span><span class="s2"> </span><span class="s1">`covid19-portfolio-project1.covid_data.covid_vaccs`</span><span class="s2"> </span><span class="s4">AS</span><span class="s2"> vaccs</span></p>
<p class="p5"><span class="s4">ON</span><span class="s1"> deaths.</span><span class="s6">location</span><span class="s1"> = vaccs.location</span></p>
<p class="p5"><span class="s4">and</span><span class="s1"> deaths.</span><span class="s6">date</span><span class="s1"> = vaccs.</span><span class="s4">date</span></p>
<p class="p5"><span class="s4">WHERE</span><span class="s1"> deaths.continent </span><span class="s4">is</span><span class="s1"> </span><span class="s4">not</span><span class="s1"> </span><span class="s4">null</span></p>
<p class="p6"><span class="s1">)</span></p>
<p class="p5"><span class="s4">SELECT</span><span class="s1"> </span><span class="s3">*</span><span class="s1">, </span><span class="s3">(</span><span class="s1">RollingPeopleVaccinated</span><span class="s3">/</span><span class="s1">population</span><span class="s3">)*</span><span class="s5">100</span></p>
<p class="p5"><span class="s4">FROM</span><span class="s1"> PopvsVac</span></p>
<p class="p7"><span class="s1"></span><br></p>
</body>
</html>
